<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="NebulaChat - современный чат с real-time коммуникацией">
  <meta name="theme-color" content="#5865F2">
  <title>NebulaChat</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Main App Container -->
  <div id="app" class="app">
    
    <!-- Server List Sidebar -->
    <aside class="server-list" role="navigation" aria-label="Серверы">
      <div class="server-list__home">
        <button class="server-icon server-icon--home server-icon--active" aria-label="Главная" data-view="home" id="home-btn">
          <svg width="24" height="24"><use href="icons.svg#home"></use></svg>
        </button>
      </div>
      <div class="server-list__separator"></div>
      <div class="server-list__items" id="server-list-items">
        <!-- Dynamic server icons -->
      </div>
      <button class="server-icon server-icon--add" aria-label="Добавить сервер" id="add-server-btn">
        <svg width="24" height="24"><use href="icons.svg#plus"></use></svg>
      </button>
    </aside>

    <!-- Channel Sidebar / Friends Sidebar -->
    <aside class="channel-sidebar" role="navigation" aria-label="Каналы">
      <div class="guild-header" id="guild-header">
        <h2 class="guild-header__name">Сервер</h2>
        <button class="guild-header__dropdown" aria-label="Меню сервера">
          <svg width="18" height="18"><use href="icons.svg#chevron-down"></use></svg>
        </button>
      </div>
      
      <!-- Friends View (показывается когда home активен) -->
      <div class="friends-sidebar" id="friends-sidebar" style="display: none;">
        <input type="text" class="friends-search" id="friends-search" placeholder="Найти или начать беседу">
        
        <div class="friends-tabs">
          <button class="friends-tab friends-tab--active" data-tab="online">
            <svg width="16" height="16"><use href="icons.svg#users"></use></svg>
            Друзья
          </button>
          <button class="friends-tab" data-tab="pending">
            Ожидают
            <span class="friends-tab__badge" id="pending-count">0</span>
          </button>
          <button class="friends-tab" data-tab="add">
            <svg width="16" height="16"><use href="icons.svg#plus"></use></svg>
            Добавить
          </button>
        </div>
        
        <div class="dm-list" id="dm-list">
          <div class="dm-section-title">Личные сообщения</div>
          <!-- Dynamic DMs -->
        </div>
      </div>
      
      <div class="channel-list" id="channel-list" role="list">
        <!-- Dynamic channels -->
      </div>

      <div class="user-panel">
        <div class="user-panel__avatar" id="user-avatar"></div>
        <div class="user-panel__info">
          <div class="user-panel__name" id="user-name">Пользователь</div>
          <div class="user-panel__status" id="user-status">онлайн</div>
        </div>
        <div class="user-panel__actions">
          <button aria-label="Настройки" class="user-panel__btn" id="settings-btn">
            <svg width="20" height="20"><use href="icons.svg#settings"></use></svg>
          </button>
        </div>
      </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
      <!-- Friends Main View -->
      <div class="friends-main" id="friends-main" style="display: none;">
        <div class="friends-header">
          <svg width="24" height="24"><use href="icons.svg#users"></use></svg>
          <h1 id="friends-title">Друзья</h1>
          <div class="friends-header__actions">
            <button class="btn btn--success" id="start-call-btn">
              <svg width="20" height="20"><use href="icons.svg#volume"></use></svg>
              Голосовой звонок
            </button>
            <button class="btn btn--primary" id="start-video-btn">
              <svg width="20" height="20"><use href="icons.svg#video"></use></svg>
              Видеозвонок
            </button>
          </div>
        </div>
        
        <div class="friends-content" id="friends-content">
          <!-- Dynamic friends list -->
        </div>
      </div>

      <!-- Chat Header -->
      <header class="chat-header" id="chat-header">
        <div class="chat-header__left">
          <button class="chat-header__mobile-toggle" aria-label="Меню">
            <svg width="24" height="24"><use href="icons.svg#menu"></use></svg>
          </button>
          <svg width="24" height="24" class="chat-header__icon"><use href="icons.svg#hashtag"></use></svg>
          <h1 class="chat-header__title" id="channel-name">общий</h1>
        </div>
        <div class="chat-header__right">
          <button aria-label="Закрепленные" class="chat-header__btn">
            <svg width="24" height="24"><use href="icons.svg#pin"></use></svg>
          </button>
          <button aria-label="Поиск" class="chat-header__btn" id="search-btn">
            <svg width="24" height="24"><use href="icons.svg#search"></use></svg>
          </button>
          <button aria-label="Участники" class="chat-header__btn" id="members-toggle">
            <svg width="24" height="24"><use href="icons.svg#users"></use></svg>
          </button>
        </div>
      </header>

      <!-- Messages Container -->
      <div class="messages-container" id="messages-container">
        <div class="messages-scroll" id="messages-scroll">
          <div class="messages-list" id="messages-list" role="log" aria-live="polite">
            <!-- Dynamic messages -->
          </div>
        </div>
      </div>

      <!-- Message Composer -->
      <div class="message-composer">
        <button class="message-composer__attach" aria-label="Прикрепить файл">
          <svg width="24" height="24"><use href="icons.svg#plus-circle"></use></svg>
        </button>
        <div class="message-composer__input-wrapper">
          <div class="message-composer__input" 
               id="message-input" 
               contenteditable="true" 
               role="textbox" 
               aria-label="Сообщение"
               data-placeholder="Сообщение в #общий"></div>
        </div>
        <div class="message-composer__actions">
          <button aria-label="Голосовой звонок" class="message-composer__btn" id="voice-call-btn">
            <svg width="24" height="24"><use href="icons.svg#volume"></use></svg>
          </button>
          <button aria-label="Видеозвонок" class="message-composer__btn" id="video-call-btn">
            <svg width="24" height="24"><use href="icons.svg#video"></use></svg>
          </button>
          <button aria-label="Эмодзи" class="message-composer__btn">
            <svg width="24" height="24"><use href="icons.svg#smile"></use></svg>
          </button>
        </div>
      </div>
    </main>

    <!-- Members Sidebar -->
    <aside class="members-sidebar" id="members-sidebar" role="complementary" aria-label="Участники">
      <div class="members-list" id="members-list" role="list">
        <!-- Dynamic members -->
      </div>
    </aside>
  </div>

  <!-- Context Menu -->
  <div class="context-menu" id="context-menu" role="menu" style="display: none;">
    <!-- Dynamic context menu items -->
  </div>

  <!-- Modal Container -->
  <div class="modal-overlay" id="modal-overlay" style="display: none;">
    <div class="modal" id="modal" role="dialog" aria-modal="true">
      <!-- Dynamic modal content -->
    </div>
  </div>

  <!-- Command Palette -->
  <div class="command-palette" id="command-palette" style="display: none;">
    <div class="command-palette__content">
      <input type="text" 
             class="command-palette__input" 
             id="command-input" 
             placeholder="Введите команду..."
             aria-label="Палитра команд">
      <div class="command-palette__results" id="command-results"></div>
    </div>
  </div>

  <!-- Call Modal -->
  <div class="call-modal" id="call-modal" style="display: none;">
    <div class="call-container">
      <div class="call-header">
        <h3 id="call-title">Звонок...</h3>
        <button class="call-minimize" id="call-minimize-btn">
          <svg width="20" height="20"><use href="icons.svg#chevron-down"></use></svg>
        </button>
      </div>
      
      <div class="call-video-container">
        <video id="remote-video" class="call-video call-video--remote" autoplay playsinline></video>
        <video id="local-video" class="call-video call-video--local" autoplay playsinline muted></video>
      </div>
      
      <div class="call-status" id="call-status">Подключение...</div>
      
      <div class="call-controls">
        <button class="call-control-btn" id="toggle-mic-btn" title="Микрофон">
          <svg width="24" height="24"><use href="icons.svg#mic"></use></svg>
        </button>
        <button class="call-control-btn" id="toggle-video-btn" title="Камера">
          <svg width="24" height="24"><use href="icons.svg#video"></use></svg>
        </button>
        <button class="call-control-btn call-control-btn--screen" id="share-screen-btn" title="Демонстрация экрана">
          <svg width="24" height="24"><use href="icons.svg#monitor"></use></svg>
        </button>
        <button class="call-control-btn call-control-btn--danger" id="end-call-btn" title="Завершить">
          <svg width="24" height="24"><use href="icons.svg#x"></use></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Load SVG Icons -->
  <div style="display: none;">
    <div id="svg-sprite-container"></div>
  </div>

  <!-- Scripts -->
  <script type="module" src="app.js"></script>
</body>
</html>

